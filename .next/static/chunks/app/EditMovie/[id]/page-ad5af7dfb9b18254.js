(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[641],{748:function(e,t,i){Promise.resolve().then(i.bind(i,3120))},3120:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return h}});var n=i(7437),a=i(2265),l=i(2737),s=i.n(l),o=i(1865),r=i(4578),c=i(8110),u=i(2996),m=i(4033),d=i(2173);let p=r.z.object({title:r.z.string().min(1,{message:"Title is required"}).min(3,{message:"Title of minimum 3 letters required"}),publishing_year:r.z.string().min(1,{message:"Publishing Date is required"}).min(4,{message:"Publishing Date must at least 4 characters"}),image:r.z.any()});function g(e){var t,i,l;let{defaultValues:r,params:g}=e,{control:h,handleSubmit:_,setValue:f,register:v,formState:{errors:b}}=(0,o.cI)({resolver:(0,c.F)(p),defaultValues:r}),x=(0,a.useRef)(null),j=(0,a.useRef)(null),[E,N]=(0,a.useState)(null),y=(0,m.useRouter)();console.log("ii",E),console.log("parmas",g);let M=()=>{console.log("Cancel button clicked")},C=async e=>{console.log("iimg",e);let t=new FormData;t.append("title",e.title),t.append("publishing_year",e.publishing_year),E&&t.append("image",E);try{let e=localStorage.getItem("token");d.Z.defaults.headers.put.Authorization=e,d.Z.defaults.headers.common["Content-Type"]="multipart/form-data";let i=await d.Z.put("http://3.144.22.101/api/movies/".concat(g),t);await i.data,200===i.status&&y.push("/MovieList")}catch(e){console.error("Error fetching movies:",e)}finally{}};return(0,a.useEffect)(()=>{(null==r?void 0:r.image)&&(N(r.image[0]),console.log("iimg",r.image[0]))},[r]),(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("form",{onSubmit:_(C),children:[(0,n.jsxs)("div",{className:s().flexContainer,children:[(0,n.jsxs)("div",{className:"".concat(s().uploadDiv," mt-10 mx-5"),children:[(0,n.jsx)("p",{className:"".concat(s().uploadText),onClick:()=>{var e;null===(e=x.current)||void 0===e||e.click()},children:"Click to Upload Image"}),(0,n.jsx)("input",{type:"file",className:s().fileUpload,...v("image"),ref:x,onChange:e=>{var t;let i=null===(t=e.target.files)||void 0===t?void 0:t[0];if(console.log("Selected file:",i),N(i),i){let e=new FileReader;e.onload=e=>{var t,i;let n=null===(t=e.target)||void 0===t?void 0:t.result;null===(i=j.current)||void 0===i||i.setAttribute("src",n)},e.readAsDataURL(i)}},onClick:e=>{e.stopPropagation()}}),!E&&(0,n.jsx)("span",{className:s().errorMsg,children:null===(t=b.image)||void 0===t?void 0:t.message}),E&&(0,n.jsx)("img",{ref:j,className:s().thumbnail,alt:"Thumbnail"})]}),(0,n.jsxs)("div",{className:"".concat(s().sideForm),children:[(0,n.jsx)(u.Z,{placeholder:"Title",control:h,setValue:f,name:"title"}),(0,n.jsx)("span",{className:s().errorMsg,children:null===(i=b.title)||void 0===i?void 0:i.message}),(0,n.jsx)(u.Z,{placeholder:"Publishing year",control:h,setValue:f,name:"publishing_year"}),(0,n.jsx)("span",{className:s().errorMsg,children:null===(l=b.publishing_year)||void 0===l?void 0:l.message}),(0,n.jsxs)("div",{className:"".concat(s().buttons," flex gap-x-2 mt-8"),children:[(0,n.jsx)("button",{className:s().cancelBtn,type:"button",onClick:()=>M(),children:"Cancel"}),(0,n.jsx)("button",{className:s().submitBtn,type:"submit",children:"Update"})]})]})]}),(0,n.jsxs)("div",{className:"".concat(s().buttonsMobile," flex gap-x-2 mt-8"),children:[(0,n.jsx)("button",{className:s().cancelBtn,type:"button",onClick:()=>M(),children:"Cancel"}),(0,n.jsx)("button",{className:s().submitBtn,type:"submit",children:"Update"})]})]})})}function h(e){let{params:t}=e,[i,l]=(0,a.useState)(null),[s,o]=(0,a.useState)(!0),[r,c]=(0,a.useState)(null);(0,a.useEffect)(()=>{u()},[]);let u=async()=>{o(!0);try{let e=localStorage.getItem("token");d.Z.defaults.headers.get.Authorization=e,d.Z.defaults.headers.common["Content-Type"]="application/json";let i=await d.Z.get("http://3.144.22.101/api/movies/".concat(t.id)),n=await i.data;console.log("Movie Data:",n),l(n)}catch(e){console.error("Error fetching movie:",e),c("Error fetching movie")}finally{o(!1)}};return(0,n.jsxs)("div",{children:[s&&(0,n.jsx)("p",{children:"Loading..."}),r&&(0,n.jsxs)("p",{children:["Error: ",r]}),i&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h2",{className:"flex align-bottom gap-2 m-6 items-center",children:"Edit"}),(0,n.jsx)(g,{defaultValues:i,params:t.id})]})]})}},2996:function(e,t,i){"use strict";var n=i(7437);i(2265);var a=i(1865),l=i(2927),s=i.n(l);t.Z=e=>{let{placeholder:t,control:i,setValue:l,reset:o,name:r,defaultValue:c}=e;return(0,n.jsx)("div",{children:(0,n.jsx)(a.Qr,{control:i,name:r,render:e=>{let{field:i}=e;return(0,n.jsx)("input",{className:"publishingDate"===r?"".concat(s().input," ").concat(s().inputDate):"title"===r?"".concat(s().input," ").concat(s().inputTitle):s().input,...i,onChange:e=>{l&&l(r,e.target.value),i.onChange(e)},placeholder:t,name:r})}})})}},2927:function(e){e.exports={input:"Input_input__7ueAE",inputDate:"Input_inputDate__FtPKH",inputTitle:"Input_inputTitle__NUTIe",inputError:"Input_inputError__Gy9Rj"}},2737:function(e){e.exports={uploadDiv:"EditMovieForm_uploadDiv__BD4Te",errorMsg:"EditMovieForm_errorMsg__buQVT",fileUpload:"EditMovieForm_fileUpload__SstaC",cancelBtn:"EditMovieForm_cancelBtn__Q3TWI",submitBtn:"EditMovieForm_submitBtn__rmGVP",flexContainer:"EditMovieForm_flexContainer__9QE_q",sideForm:"EditMovieForm_sideForm__h0N1U",thumbnail:"EditMovieForm_thumbnail__2fUZ3",buttonsMobile:"EditMovieForm_buttonsMobile___o4QB",buttons:"EditMovieForm_buttons__k2hYf"}}},function(e){e.O(0,[630,329,971,938,744],function(){return e(e.s=748)}),_N_E=e.O()}]);